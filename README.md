# Disclaimer

Задача решена для формального соответствия ТЗ, на базовом уровне, в частности:
- не проводилась оптимизация БД в части объема хранения:
  - не решался вопрос использования UUID как ID записи,
  - UUID хранится в текстовом виде для наглядности,
  - максимальные длины полей заданы произвольно,
  - не рассматривался вопрос масштабирования БД в части использования встроенного механизма реляций, и т.д.
- Сообщения об ошибке вызовов передаются вызывающей функции, как они представлены в объекте Exception.


# Запуск проекта
Для запуска контейнеров Docker в корневой папке проекта выполните команду:

    docker compose up -d

# Администрирование
Для доступа к приложению Adminer (администрирование БД Postgres) откройте URL (если вы запускали проект на локальном ПК):

    http://localhost:8081

Данные для доступа к БД

| Field            | Value        |
|------------------|--------------|
| Движок           | PostgreSQL   |
| Сервер           | db           |
| Имя пользователя | WebRise      |
| Пароль           | wr_secret1   |
| База данных      | subscription |

# API

Для доступа к API обратитесь к эндпойнту нужной функции по URL (если вы запускали проект на локальном ПК):

    http://localhost:8081/<URL функции>

Параметры функций указаны в их описаниях.
Параметры методов HTTP POST и PUT передаются в теле запроса в формате JSON.
Параметры методов HTTP GET и DELETE передаются в URI запроса.

## Создание пользователя

### Описание эндпойнта

| Field | Value  |
|-------|--------|
| URL   | /users |
| метод | POST   |

### Описание параметров

| Параметр  | Обязательный | Описание                               |
|-----------|--------------|----------------------------------------|
| email     | да           | Уникальный почтовый адрес пользователя |
| firstName | нет          | Имя пользователя                       |
| lastName  | нет          | Фамилия пользователя                   |

### Описание результатов

В случае успешного выполнения, функция возвращает статус 200, а в теле - запись пользователя в формате JSON:

| Параметр      | Описание                                     |
|---------------|----------------------------------------------|
| uniqueId      | Уникальный идентификатор пользователя (UUID) |
| email         | Уникальный почтовый адрес пользователя       |
| firstName     | Имя пользователя                             |
| lastName      | Фамилия пользователя                         |
| subscriptions | Подписки пользователя                        |

В случае ошибки валидации запроса, функция возвращает статус 400, а в теле - сообщение об ошибке в формате JSON:

| Параметр  | Описание                                                  |
|-----------|-----------------------------------------------------------|
| timestamp | Временная метка ответа сервера                            |
| status    | Статус запроса HTTP                                       |
| error     | Сообщение об ошибке, соответствующее статусу запроса HTTP |
| path      | URI запроса                                               |

В случае ошибки выполнения запроса, функция возвращает статус 500, а в теле - сообщение об ошибке в формате JSON:

| Параметр | Описание            |
|----------|---------------------|
| message  | Сообщение об ошибке |

### Пример выполнения вызова

    curl -X "POST" -H "Content-type: application/json" -d '{"email": "a@b.e", "firstName": "Кукуку", "lastName": "Бебебе"}' "localhost:8080/users"

## Получение информации о пользователе

### Описание эндпойнта

| Field       | Value       |
|-------------|-------------|
| URL         | /users/{id} |
| метод       | GET         |

### Описание параметров

| Параметр  | Обязательный | Описание                                     |
|-----------|--------------|----------------------------------------------|
| id        | да           | Уникальный идентификатор пользователя (UUID) |

### Описание результатов

В случае если пользователь не найден, функция возвращает статус 404.
Остальные результаты выполнения запроса аналогичны описанным выше для функции Создание пользователя.

### Пример выполнения вызова

    curl "http://localhost:8080/users/5b33faa5-92b7-4c60-ac46-9c38e07604c7"

## Обновление данных пользователя

### Описание эндпойнта

| Field       | Value       |
|-------------|-------------|
| URL         | /users/{id} |
| метод       | PUT         |

### Описание параметров

Уникальный идентификатор пользователя передается в URI запроса, как это описано выше для функции 
Получение информации о пользователе.
Обновленные данные пользователя передаются в теле запроса, как это описано выше для функции Создание пользователя.

#### Особенности обработки параметров

Если обязательные поля данных пользователя не переданы в запросе, они остаются прежними.
Если необязательные поля данных пользователя не переданы в запросе, они обнуляются в записи пользователя в БД.

### Описание результатов

Результаты выполнения запроса аналогичны описанным выше для функции Создание пользователя.

### Пример выполнения вызова

    curl -X "PUT" -H "Content-type: application/json" -d '{"firstName": "Кукукух"}' "http://localhost:8080/users/5b33faa5-92b7-4c60-ac46-9c38e07604c7"

Данный запрос изменяет имя пользователя, обнуляет его фамилию и оставляет прежний почтовый адрес.


